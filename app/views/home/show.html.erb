<h1> Homepage </h1>

<div id="map-canvas" style="width: 100%; height: 500px"></div>


<script>

  function initialize() {
    var myLatlng = new google.maps.LatLng(55.9532520,-3.1882670);
    var mapOptions = {
      zoom: 12,
      center: myLatlng,
      draggable: true
    }
    var locations = <%= raw Marker.produce_array %>
    console.log('locations', locations)
    var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

    // var marker = new google.maps.Marker({
    //     position: myLatlng,
    //     map: map,
    //     title: 'Hello World!'
    // });
    var infowindow = new google.maps.InfoWindow;
    var marker, i;
    for (i = 0; i < locations.length; i++) {  
    marker = new google.maps.Marker({
         position: new google.maps.LatLng(locations[i][1], locations[i][2]),
         map: map
    });

    google.maps.event.addListener(marker, 'click', (function(marker, i) {
         return function() {
             var contentString = "<p>" + locations[i][0] + " is a " + locations[i][3] + " located at " + locations[i][7] + " " +locations[i][9]+ " " + locations[i][8] + ". It is open from " + locations[i][5] + " until " + locations[i][6] + ". </p>"
             infowindow.setContent(contentString);
             infowindow.open(map, marker);
         }
    })(marker, i));
  }

  }

  google.maps.event.addDomListener(window, 'load', initialize);

</script>